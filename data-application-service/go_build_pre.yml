steps:
  - task: DownloadSecureFile@1
    name: sshKey
    inputs:
      secureFile: 'ContentBuildSSHkey'
  - script: |
      # 添加SSH KEY
      echo Installing $(sshKey.secureFilePath) to ssh key...
      mkdir /root/.ssh
      chown root:root $(sshKey.secureFilePath)
      chmod 600 $(sshKey.secureFilePath)
      cp $(sshKey.secureFilePath) /root/.ssh/id_rsa
      ssh-keyscan -t rsa devops.aishu.cn>> ~/.ssh/known_hosts
      ssh-keyscan -t rsa gitlab.aishu.cn>> ~/.ssh/known_hosts
      # 配置go env 和 git config
      go env -w GOPRIVATE=devops.aishu.cn,gitlab.aishu.cn
      git config --global url."ssh://devops.aishu.cn:22/AISHUDevOps/".insteadOf "https://devops.aishu.cn/AISHUDevOps/"
      echo machine devops.aishu.cn login dashuai.wang password $(System.AccessToken) >> /root/.netrc
      export NETRC=/root/.netrc
      export GO111MODULE=on
      export CGO_ENABLED=1
